"use strict";(self.webpackChunkmy_vuepress_site=self.webpackChunkmy_vuepress_site||[]).push([[557],{17649:(a,e,i)=>{i.r(e),i.d(e,{comp:()=>m,data:()=>h});var l=i(20641);const s=i.p+"assets/img/1.1f404284.png",t=i.p+"assets/img/2.1e747693.png",n=i.p+"assets/img/3.3582822d.png",r=i.p+"assets/img/4.76db946a.png",c=i.p+"assets/img/5.9fdbb6fc.png",p=i.p+"assets/img/6.ed41ed7d.png",d=i.p+"assets/img/7.963c458b.png",o=i.p+"assets/img/8.d5153b04.png",g={},m=(0,i(66262).A)(g,[["render",function(a,e){return(0,l.uX)(),(0,l.CE)("div",null,e[0]||(e[0]=[(0,l.Fv)('<h3 id="_1-问题描述" tabindex="-1"><a class="header-anchor" href="#_1-问题描述"><span>1. 问题描述</span></a></h3><ol><li>大连生产abc正在做交易时，报错：“接收到有同名节点登录上端服务器的冲突提示，失去通讯能力，程序退出！” <img src="'+s+'" alt="图片描述"></li></ol><h3 id="_2-问题分析" tabindex="-1"><a class="header-anchor" href="#_2-问题分析"><span>2. 问题分析</span></a></h3><p>报出此问题原因为申请oid时发现abs已经存在相同的oid。发生该问题的一般原因为：</p><ol><li>两个abc配置相同的cellname，导致第二个申请oid时报出该错误。</li><li>Abc关闭时，由于某种异常导致abs没有清理到该abc对应的oid。</li></ol><p>目前abc的oid生成策略为abcoid=absoid.+计算机名+ip，经和行方确认不存在计算机名+ip重复的可能性。所以排除猜1的可能性。 由于改问题是在交易运行时产生，所以基本排除了猜想2的可能性。 到此为止，以上两点猜想都不成立。拿到通讯日志。在abc的communication.log中看到报错： <img src="'+t+'" alt="图片描述"> 在报错前发现abc已经与F5断开（大连abc和abs之间通讯增加F5），并且已经发起重连行为： <img src="'+n+'" alt="图片描述"> 并且发现在abs的communication.log日志在相同时间点发现相同的oid注册： <img src="'+r+'" alt="图片描述"> 由日志中可以看到，在1m之内，发起了3次注册相同oid的请求（oldChannelId:[/10.190.2.17:53092] newChannelId:[/10.190.2.17:53092]），可以确定是同一个abc发起了3次请求。查看客户端请求部分源码，并经过本地源码调试发现3次请求分别是 1)PreferenceClient.java中注册的ICellListener中的postStartup()方法的执行 2)GuiView.java中注册的ICellListener中的postStartup()方法的执行 3)ResourceClient.java中注册的ICellListener中的postStartup()方法的执行 Abc启动时，加载预启动服务--&gt;执行Cell的start，started成员变量置为了true--&gt;执行ICellListener中的postStartup()方法。 <img src="'+c+'" alt="图片描述"> 因为上面3个类中实现的postStartup()方法都调用了Cell.getOid()方法 <img src="'+p+'" alt="图片描述"> 也就是说，15秒钟(超时时间)才能请求1次oid，然后，从客户端的communication.log中可以看出 <img src="'+d+'" alt="图片描述"> 从“连接已启动”到“启动通讯服务成功”耗时42秒钟，正好发送3次oid请求。</p><h3 id="_3-问题解决" tabindex="-1"><a class="header-anchor" href="#_3-问题解决"><span>3. 问题解决</span></a></h3><ol><li>协调F5，不缓存通讯数据，失败后直接返回。</li><li>将cell进行改造，abs发现oid已经被重复注册后，校验channelid是否是同一个，如果是同一个直接return <img src="'+o+'" alt="图片描述"></li></ol><h3 id="习题" tabindex="-1"><a class="header-anchor" href="#习题"><span>习题</span></a></h3><p>目前平台采用的oid生成策略是什么？</p>',10)]))}]]),h=JSON.parse('{"path":"/AB%E4%BA%A7%E5%93%81%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%B9%B3%E5%8F%B0/AB4/%E5%B8%82%E5%9C%BA%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86%E6%A1%88%E4%BE%8B/abc%E7%BB%8F%E8%BF%87F5%E6%8A%A5%E9%94%99%E9%87%8D%E5%A4%8D%E8%8A%82%E7%82%B9%E6%B3%A8%E5%86%8C%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":3,"title":"1.  问题描述","slug":"_1-问题描述","link":"#_1-问题描述","children":[]},{"level":3,"title":"2.  问题分析","slug":"_2-问题分析","link":"#_2-问题分析","children":[]},{"level":3,"title":"3.  问题解决","slug":"_3-问题解决","link":"#_3-问题解决","children":[]},{"level":3,"title":"习题","slug":"习题","link":"#习题","children":[]}],"git":{"updatedTime":1727145923000,"contributors":[{"name":"wangaoqi","email":"wangaoqi@agree.com.cn","commits":1}]},"filePathRelative":"AB产品知识库/平台/AB4/市场问题处理案例/abc经过F5报错重复节点注册案例分析.md"}')}}]);